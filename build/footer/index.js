(()=>{"use strict";var e={n:o=>{var l=o&&o.__esModule?()=>o.default:()=>o;return e.d(l,{a:l}),l},d:(o,l)=>{for(var r in l)e.o(l,r)&&!e.o(o,r)&&Object.defineProperty(o,r,{enumerable:!0,get:l[r]})},o:(e,o)=>Object.prototype.hasOwnProperty.call(e,o)};const o=window.wp.blocks,l=window.wp.i18n,r=window.wp.blockEditor,t=window.wp.components,a=window.wp.apiFetch;var n=e.n(a);const i=window.wp.element,c=window.ReactJSXRuntime;(0,o.registerBlockType)("carpentry/footer",{edit:function({attributes:e,setAttributes:o}){const{logoId:a,logoUrl:s,logoAlt:d,useGlobalFooterLogo:p}=e,g=(0,r.useBlockProps)(),[h,y]=(0,i.useState)({id:0,url:"",alt:""}),[u,b]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{p&&(b(!0),n()({path:"/carpentry/v1/footer-logo"}).then(e=>y(e||{id:0,url:"",alt:""})).catch(()=>y({id:0,url:"",alt:""})).finally(()=>b(!1)))},[p]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.InspectorControls,{children:(0,c.jsxs)(t.PanelBody,{title:(0,l.__)("Logo del Footer","carpentry-blocks"),initialOpen:!0,children:[(0,c.jsx)(t.ToggleControl,{label:(0,l.__)("Usar logo global del footer","carpentry-blocks"),checked:!!p,onChange:e=>o({useGlobalFooterLogo:!!e}),help:(0,l.__)("Cuando está activo, se usará el logo configurado en el Personalizador para todas las páginas.","carpentry-blocks")}),p?(0,c.jsxs)(c.Fragment,{children:[u?(0,c.jsx)("p",{children:(0,l.__)("Cargando logo global…","carpentry-blocks")}):h?.url?(0,c.jsx)("div",{style:{margin:"0 0 12px"},children:(0,c.jsx)("img",{src:h.url,alt:h.alt||(0,l.__)("Logo footer","carpentry-blocks"),style:{maxWidth:"100%",height:"auto"}})}):(0,c.jsx)("p",{style:{marginTop:8},children:(0,l.__)("No hay logo global de footer configurado. Puedes establecer uno a continuación.","carpentry-blocks")}),(0,c.jsx)(r.MediaUploadCheck,{children:(0,c.jsx)(r.MediaUpload,{onSelect:async e=>{if(e)try{b(!0),await n()({path:"/carpentry/v1/footer-logo",method:"POST",data:{id:e.id,alt:e.alt||e.title||""}}),y({id:e.id,url:e.url,alt:e.alt||e.title||""})}finally{b(!1)}},allowedTypes:["image"],value:h?.id||0,render:({open:e})=>(0,c.jsx)(t.Button,{variant:"primary",onClick:e,disabled:u,children:h?.id?(0,l.__)("Cambiar logo global del footer","carpentry-blocks"):(0,l.__)("Seleccionar logo global del footer","carpentry-blocks")})})})]}):(0,c.jsxs)(c.Fragment,{children:[s?(0,c.jsx)("div",{style:{marginBottom:"1rem"},children:(0,c.jsx)("img",{src:s,alt:d||(0,l.__)("Logo","carpentry-blocks"),style:{maxWidth:"100%",height:"auto"}})}):(0,c.jsx)("p",{children:(0,l.__)("No hay logo seleccionado.","carpentry-blocks")}),(0,c.jsx)(r.MediaUploadCheck,{children:(0,c.jsx)(r.MediaUpload,{onSelect:e=>{e&&o({logoId:e.id||0,logoUrl:e.url||"",logoAlt:e.alt||e.title||""})},allowedTypes:["image"],value:a,render:({open:e})=>(0,c.jsx)(t.Button,{variant:"primary",onClick:e,style:{marginRight:8},children:s?(0,l.__)("Cambiar logo","carpentry-blocks"):(0,l.__)("Seleccionar logo","carpentry-blocks")})})}),s&&(0,c.jsx)(t.Button,{variant:"secondary",onClick:()=>{o({logoId:0,logoUrl:"",logoAlt:""})},isDestructive:!0,children:(0,l.__)("Quitar","carpentry-blocks")}),s&&(0,c.jsx)(t.TextControl,{label:(0,l.__)("Texto alternativo","carpentry-blocks"),value:d,onChange:e=>o({logoAlt:e}),help:(0,l.__)("Importante para accesibilidad e SEO.","carpentry-blocks")})]})]})}),(0,c.jsx)("div",{...g,children:(0,c.jsxs)("div",{style:{background:"#2c3e50",color:"white",padding:"2rem",textAlign:"center"},children:[(0,c.jsx)("h3",{children:(0,l.__)("Footer de ServiLucas","carpentry-blocks")}),(0,c.jsx)("p",{children:(0,l.__)("Este es el footer (vista previa). El contenido final y el logo se renderizan en el frontend.","carpentry-blocks")}),s&&(0,c.jsx)("div",{style:{marginTop:"1rem"},children:(0,c.jsx)("img",{src:s,alt:d||(0,l.__)("Logo","carpentry-blocks"),style:{maxWidth:200,height:"auto"}})})]})})]})},save:()=>null})})();